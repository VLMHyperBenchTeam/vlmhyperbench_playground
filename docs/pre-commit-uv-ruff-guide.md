# Руководство по настройке Ruff, pre-commit и uv

Этот документ описывает, как настроить расширение Ruff для VS Code, использовать конфигурацию из pre-commit hooks, запускать хуки вручную и интегрировать менеджер пакетов uv.

## 1. Настройка расширения Ruff в VS Code

Расширение [Ruff](https://marketplace.visualstudio.com/items?itemName=charliermarsh.ruff) для VS Code автоматически использует конфигурацию проекта.

### Как это работает
- Ruff ищет конфигурационные файлы в корне проекта: `pyproject.toml`, `ruff.toml` или `.ruff.toml`.
- Если вы используете `pyproject.toml` для настройки Ruff (в секции `[tool.ruff]`), то и pre-commit hooks, и расширение VS Code будут использовать одни и те же правила.
- Это обеспечивает согласованность между проверками в редакторе и при коммите.

### Пример конфигурации в `pyproject.toml`
```toml
[tool.ruff]
select = ["E", "W", "F"] # Ошибки, предупреждения, стилистические проблемы
ignore = ["E501"] # Игнорировать длинные строки
```

## 2. Запуск pre-commit hooks вручную

Вы можете запускать pre-commit hooks без выполнения коммита.

### Команды
- Запустить хуки на всех отслеживаемых файлах:
  ```bash
  pre-commit run
  ```
- Запустить хуки на всех файлах в репозитории (включая неотслеживаемые):
  ```bash
  pre-commit run --all-files
  ```
- Запустить конкретный хук:
  ```bash
  pre-commit run <hook-id>
  ```

## 3. Интеграция uv с pre-commit

Менеджер пакетов [uv](https://github.com/astral-sh/uv) можно интегрировать с pre-commit для ускорения установки зависимостей.

### Установка pre-commit с поддержкой uv
```bash
uv tool install pre-commit --with pre-commit-uv
```
- Эта команда устанавливает `pre-commit` как глобальный инструмент.
- Флаг `--with pre-commit-uv` добавляет плагин, который использует `uv` вместо `pip` для установки зависимостей хуков.

### Как это работает
- Плагин `pre-commit-uv` работает прозрачно.
- Когда pre-commit устанавливает хуки (например, ruff, black), он использует `uv` для создания окружения и установки пакетов.
- Это значительно ускоряет процесс по сравнению с использованием `pip`.

### Запуск хуков
После установки используйте стандартные команды pre-commit:
```bash
pre-commit run --all-files
```
**Важно:** Не используйте `uv run pre-commit ...`. Команда `pre-commit` доступна напрямую после установки через `uv tool install`.