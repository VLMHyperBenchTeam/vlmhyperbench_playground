# План реализации VLMHyperBench v0.2.0

Этот документ описывает детальный план обновления фреймворка до версии v0.2.0. Основные цели: внедрение асинхронности, гибкое управление промптами, стандартизация API инференса, управление данными, продвинутая система метрик и создание удобного UI.

## Обзор изменений

1.  **Управление промптами (Prompt Management)**: Переход от жестко заданных промптов к динамическому выбору на основе конфигурации и метаданных документов.
2.  **API Wrapper**: Внедрение промежуточного слоя (FastAPI) для унификации интерфейсов различных движков (vLLM, SGLang, HF) и сбора метрик.
3.  **Асинхронность**: Перевод основного цикла инференса (`run_vlm.py`) на `asyncio`.
4.  **Поддержка DeepSeek**: Добавление специализированного адаптера для DeepSeek-OCR.
5.  **Data Layer**: Абстракция доступа к данным (Smart Sync) с поддержкой локального хранилища (и S3 в будущем).
6.  **Metric Registry & Validation**: Гибкая система метрик, валидация JSON через Pydantic и метрики производительности.
7.  **Reporting Engine**: Генерация красивых Markdown отчетов и JSON-артефактов.
8.  **Task Registry**: Декларативное описание задач (MLTask) и экспериментов (RunTask) в YAML.
9.  **Orchestrator v2**: Параллельный запуск задач и управление ресурсами.
10. **Management Plane**: Создание центрального Backend и Frontend для управления экспериментами.
11. **Component Placement**: Четкое разделение ответственности между Host и Container слоями.
12. **Dependency Injection & Plugins**: Динамическая установка пакетов в контейнеры и поддержка пользовательских плагинов.
13. **Testing**: Комплексная стратегия тестирования (Unit, Integration, E2E).

## Этапы реализации

### Этап 1: Проектирование Схем (Foundation)
**Цель**: Определить форматы конфигурационных файлов и интерфейсы.
**Задачи**:
*   `plans/task_16_registry_schema_design.md` (Pydantic Models для MLTask, RunTask, ExperimentPlan).

### Этап 2: Core Components
**Цель**: Реализовать базовые абстракции и утилиты.
**Задачи**:
*   `plans/task_01_prompt_manager.md` (Prompt Resolver).
*   `plans/task_07_data_layer.md` (Storage Interface).
*   `plans/task_11_task_registry.md` (Task Loaders).
*   `plans/task_13_dependency_injection.md` (Package Installer).
*   `plans/task_15_dynamic_plugin_system.md` (Plugin Loader).

### Этап 3: Inference Layer
**Цель**: Обеспечить запуск моделей и генерацию ответов.
**Задачи**:
*   `plans/task_02_api_wrapper.md` (FastAPI Proxy).
*   `plans/task_03_deepseek_adapter.md` (Model Adapter).
*   `plans/task_14_dataset_iterator_refactor.md` (Dataset Plugins).
*   `plans/task_04_async_inference.md` (Async Loop).

### Этап 4: Evaluation & Reporting
**Цель**: Оценка качества и генерация отчетов.
**Задачи**:
*   `plans/task_08_metric_evaluator.md` (Metric Registry).
*   `plans/task_09_reporting_engine.md` (Report Generator).

### Этап 5: Orchestration & Management
**Цель**: Управление процессами и интерфейс пользователя.
**Задачи**:
*   `plans/task_10_orchestrator_refactor.md` (Async Orchestrator).
*   `plans/task_12_component_placement.md` (Architecture).
*   `plans/task_05_management_backend.md` (Backend API).
*   `plans/task_06_web_ui.md` (Frontend Dashboard).

### Этап 6: Testing & Quality Assurance
**Цель**: Обеспечить надежность системы.
**Задачи**:
*   `plans/task_17_testing_strategy.md` (Unit, Integration, Smoke Tests).

## График выполнения (Ориентировочный порядок)

1.  `task_16_registry_schema_design` (Foundation) ✅ ВЫПОЛНЕНО
2.  `task_11_task_registry` (Configuration) ✅ ВЫПОЛНЕНО
3.  `task_01_prompt_manager` (Core) ✅ ВЫПОЛНЕНО
4.  `task_07_data_layer` (Core) ✅ ВЫПОЛНЕНО
5.  `task_13_dependency_injection` & `task_15_dynamic_plugin_system` (Core) ✅ ВЫПОЛНЕНО
6.  `task_02_api_wrapper` & `task_03_deepseek_adapter` (Inference) ✅ ВЫПОЛНЕНО
7.  `task_14_dataset_iterator_refactor` (Inference) ✅ ВЫПОЛНЕНО
8.  `task_04_async_inference` (Inference) ✅ ВЫПОЛНЕНО
9.  `task_08_metric_evaluator` (Eval) ✅ ВЫПОЛНЕНО
10. `task_09_reporting_engine` (Reporting)
11. `task_10_orchestrator_refactor` & `task_12_component_placement` (Orchestration)
12. `task_05_management_backend` (Management)
13. `task_06_web_ui` (Management)
14. `task_17_testing_strategy` (QA)

## Критерии приемки v0.2.0

*   [ ] Конфигурация полностью декларативна (YAML) и валидируется Pydantic схемами.
*   [ ] Пользователи могут подключать свои датасеты и метрики через плагины (Python-пакеты).
*   [ ] Оркестратор автоматически управляет зависимостями в контейнерах.
*   [ ] Поддерживается асинхронный и параллельный запуск задач.
*   [ ] Доступен удобный Web UI для управления и мониторинга.
*   [ ] Код покрыт тестами, основные сценарии проходят проверку.